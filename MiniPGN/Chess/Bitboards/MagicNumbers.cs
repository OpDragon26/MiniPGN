namespace MiniPGN.Chess.Bitboards;

public static class MagicNumbers
{
    public static ulong Calculate(this (ulong number, int shift, ulong highest) magic, ulong value)
    {
        return (value * magic.number) >> magic.shift;
    }

    public static readonly (ulong number, int shift, ulong highest)[] RookMagics =
    [
        (985269231055635470, 48, 65516), (88166043973112679, 48, 65534), (3142386746884846368, 48, 65534),
        (864685542677365716, 48, 65535), (2586283378586882472, 48, 65531), (2808417361033323468, 48, 65526),
        (1890911079171246650, 48, 65534), (17597371001195469, 48, 65534), (120178031862261632, 48, 65535),
        (226365867627612961, 48, 65534), (1803292394500580898, 48, 65535), (628050608239734485, 48, 65534),
        (2696555272305511144, 48, 65535), (251154625980345332, 48, 65534), (1800855270149852554, 48, 65535),
        (1661702442684751473, 48, 65534), (3773389388844165302, 48, 65531), (1114559375048185792, 48, 65535),
        (335923577310636000, 48, 65535), (100540877569138224, 48, 65534), (448896125323751619, 48, 65529),
        (402728019515214435, 48, 65528), (78079743476472726, 48, 65534), (1583591028199297957, 48, 65534),
        (199608609545038680, 48, 65531), (402837107384564505, 48, 65535), (466192324685599824, 48, 65532),
        (3246798063511812784, 48, 65533), (516527357472112388, 48, 65535), (828848002071957644, 48, 65534),
        (665791693758310326, 48, 65527), (1406234913161790305, 48, 65531), (666619156322712000, 48, 65535),
        (2295928177972333224, 48, 65535), (541982671375007904, 48, 65525), (1768753854539137510, 48, 65534),
        (1833859134455981226, 48, 65533), (1917119382303460700, 48, 65534), (272015445615232110, 48, 65534),
        (1960881461222217471, 48, 65533), (1829188553056641106, 48, 65535), (667812856296936000, 48, 65536),
        (103392740192621472, 48, 65533), (1744696195693854480, 48, 65534), (2756845471060328450, 48, 65530),
        (1174756525781363190, 48, 65533), (256548231698251778, 48, 65527), (785608942720236661, 48, 65535),
        (775684189092745618, 48, 65534), (896506450283725868, 48, 65534), (1031632701515404912, 48, 65531),
        (554887461386391056, 48, 65529), (2442613442305782264, 48, 65534), (1251382294791139708, 48, 65535),
        (3783162620032623730, 48, 65534), (45277505144973003, 48, 65534), (2106168043083205235, 48, 65535),
        (329555068577983877, 48, 65535), (940861191299840481, 48, 65535), (3682788081504547607, 48, 65532),
        (1106614071577051273, 48, 65522), (2881137641324950525, 48, 65534), (249682364488344825, 48, 65533),
        (105546078198474498, 48, 65534)
    ];

    public static readonly (ulong number, int shift, ulong highest)[] BishopMagics =
    [
        (494709800317472383, 56, 255), (560972238869203738, 55, 486), (2717781773196150738, 55, 504),
        (939642809630685322, 55, 502), (486192400229141736, 56, 253), (892485468689601601, 55, 502),
        (1341754556576392512, 56, 255), (384446446474414830, 56, 253), (379162889566217258, 55, 478),
        (1964795772398256305, 53, 2044), (2341394534974752, 52, 4046), (833197427144161948, 52, 4061),
        (735226675941557572, 52, 4079), (204624472616510850, 52, 4076), (576944593331793940, 52, 4072),
        (97153958862162300, 56, 256), (652884615649715075, 55, 503), (664270180741026590, 53, 2044),
        (403007789309175875, 50, 16368), (339667767615089984, 49, 32721), (840020876452811755, 49, 32702),
        (498891985251899535, 49, 32708), (1318358237079891904, 52, 4071), (32637860325120096, 56, 255),
        (526670709003025537, 55, 502), (503347734830482532, 52, 4061), (311038710321896998, 50, 16374),
        (1443974297187639927, 47, 131022), (2924357302504919424, 47, 131015), (4208020613979328003, 50, 16373),
        (164617405155942960, 52, 4074), (648838307250553424, 55, 502), (9136312009012151, 55, 485),
        (347699285346277800, 53, 2044), (1541779454812036396, 50, 16383), (1230814705059321142, 47, 130979),
        (2021460003568730413, 47, 131015), (329012925492998648, 49, 32712), (2149188440174695440, 53, 2044),
        (688959399673969176, 56, 256), (2295373128098463504, 55, 503), (3259664754941016048, 52, 4077),
        (3941236466105569288, 49, 32737), (3518308790503570196, 50, 16369), (402520958147633498, 50, 16373),
        (274809729112311125, 50, 16353), (767919169855520022, 52, 4058), (1512343876500629868, 56, 256),
        (3577423334559714240, 56, 255), (605228271600670240, 53, 2043), (331946971558327440, 53, 1987),
        (119974011932424888, 53, 2041), (66741893432811300, 52, 4062), (3163362986076518666, 52, 4053),
        (529783039347891417, 53, 2047), (537848136131348498, 56, 254), (708661581758374452, 55, 500),
        (2684811538842272784, 56, 255), (289167398886342876, 55, 487), (848792910474022255, 55, 498),
        (300933994102163100, 56, 255), (972623042956492259, 56, 255), (2479504011002442148, 55, 503),
        (1773560169451352048, 56, 255)
    ];
}